+ : /opt/vwdata
+ : /usr/bin/sqlite3
+ : /usr/bin/rclone
+ : /usr/bin/gpg
+ : /usr/local/bin/age
+ DATA_DIR=/opt/vwdata
+ BACKUP_ROOT=/opt/vwbackups
++ date +%Y%m%d-%H%M
+ BACKUP_TIMESTAMP=20230926-0100
+ BACKUP_DIR_NAME=vaultwarden-20230926-0100
+ BACKUP_DIR_PATH=/opt/vwbackups/vaultwarden-20230926-0100
+ BACKUP_FILE_DIR=archives
+ BACKUP_FILE_NAME=vaultwarden-20230926-0100.tar.xz
+ BACKUP_FILE_PATH=/opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz
+ DB_FILE=db.sqlite3
+ source /opt/vwbackups/backup.conf
++ GPG_CIPHER_ALGO=AES128
++ GPG_PASSPHRASE=NotRealPasswordGoodTryTho
++ RCLONE_DESTS=(storj:vaultwarden-backups/)
+ cd /opt/vwdata
+ mkdir -p /opt/vwbackups/vaultwarden-20230926-0100
+ busy_timeout=30000
+ /usr/bin/sqlite3 -cmd '.timeout 30000' 'file:/opt/vwdata/db.sqlite3?mode=ro' '.backup '\''/opt/vwbackups/vaultwarden-20230926-0100/db.sqlite3'\'''
+ backup_files=()
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/attachments ]]
+ backup_files+=("${DATA_DIR}"/$f)
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/config.json ]]
+ backup_files+=("${DATA_DIR}"/$f)
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/rsa_key.der ]]
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/rsa_key.pem ]]
+ backup_files+=("${DATA_DIR}"/$f)
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/rsa_key.pub.der ]]
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/rsa_key.pub.pem ]]
+ backup_files+=("${DATA_DIR}"/$f)
+ for f in attachments config.json rsa_key.der rsa_key.pem rsa_key.pub.der rsa_key.pub.pem sends
+ [[ -e /opt/vwdata/sends ]]
+ backup_files+=("${DATA_DIR}"/$f)
+ cp -a /opt/vwdata/attachments /opt/vwdata/config.json /opt/vwdata/rsa_key.pem /opt/vwdata/rsa_key.pub.pem /opt/vwdata/sends /opt/vwbackups/vaultwarden-20230926-0100
+ tar -cJf /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz -C /opt/vwbackups vaultwarden-20230926-0100
+ rm -rf /opt/vwbackups/vaultwarden-20230926-0100
+ md5sum /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz
0f65328f3a51af44ea9f8f75a0e185d6  /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz
+ sha1sum /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz
5687705052ac37da3abba625b85e46e36a860666  /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz
+ [[ -n NotRealPasswordGoodTryTho ]]
+ /usr/bin/gpg -e --armor -r vault@jupiterservers.icu -o /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz
+ BACKUP_FILE_NAME+=.gpg
+ BACKUP_FILE_PATH+=.gpg
+ md5sum /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg
4f8908fd43006a8371cf361805e5f1eb  /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg
+ sha1sum /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg
b0c3888d8e7e2c294f3a9e6578840dc271dcdd60  /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg
+ set +e
+ success=0
+ for dest in "${RCLONE_DESTS[@]}"
+ /usr/bin/rclone -vv --no-check-dest copy /opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg storj:vaultwarden-backups/
2023/09/26 01:00:01 DEBUG : rclone: Version "v1.64.0" starting with parameters ["/usr/bin/rclone" "-vv" "--no-check-dest" "copy" "/opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg" "storj:vaultwarden-backups/"]
2023/09/26 01:00:01 DEBUG : Creating backend with remote "/opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg"
2023/09/26 01:00:01 DEBUG : Using config file from "/root/.config/rclone/rclone.conf"
2023/09/26 01:00:01 DEBUG : fs cache: adding new entry for parent of "/opt/vwbackups/archives/vaultwarden-20230926-0100.tar.xz.gpg", "/opt/vwbackups/archives"
2023/09/26 01:00:01 DEBUG : Creating backend with remote "storj:vaultwarden-backups/"
2023/09/26 01:00:01 DEBUG : FS sj://vaultwarden-backups: connecting...
2023/09/26 01:00:01 DEBUG : FS sj://vaultwarden-backups: connected: <nil>
2023/09/26 01:00:01 DEBUG : fs cache: renaming cache item "storj:vaultwarden-backups/" to be canonical "storj:vaultwarden-backups"
2023/09/26 01:00:01 DEBUG : vaultwarden-20230926-0100.tar.xz.gpg: Need to transfer - File not found at Destination
2023/09/26 01:00:01 DEBUG : FS sj://vaultwarden-backups: cp input ./vaultwarden-20230926-0100.tar.xz.gpg # [HashesOption([])] 12927
2023/09/26 01:00:02 INFO  : vaultwarden-20230926-0100.tar.xz.gpg: Copied (new)
2023/09/26 01:00:02 INFO  : 
Transferred:   	   12.624 KiB / 12.624 KiB, 100%, 12.613 KiB/s, ETA 0s
Transferred:            1 / 1, 100%
Elapsed time:         1.1s

2023/09/26 01:00:02 DEBUG : 210 go routines active
+ ((  success++  ))
+ [[ 1 == 1 ]]
+ echo 'Backup successfully copied to all destinations.'
Backup successfully copied to all destinations.
+ exit 0
